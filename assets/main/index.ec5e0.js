window.__require=function e(t,n,o){function r(a,s){if(!n[a]){if(!t[a]){var c=a.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(i)return i(c,!0);throw new Error("Cannot find module '"+a+"'")}a=c}var u=n[a]={exports:{}};t[a][0].call(u.exports,function(e){return r(t[a][1][e]||e)},u,u.exports,e,t,n,o)}return n[a].exports}for(var i="function"==typeof __require&&__require,a=0;a<o.length;a++)r(o[a]);return r}({AuthService:[function(e,t,n){"use strict";cc._RF.push(t,"f948aW0QKBDb5F6NBu6ynCi","AuthService");var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{c(o.next(e))}catch(t){i(t)}}function s(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((o=o.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.AuthService=void 0;var i=e("../constants/StorageKeys"),a=e("./PortalContextService"),s=function(){function e(){}return e.signUp=function(e,t){return o(this,void 0,Promise,function(){var n,o;return r(this,function(r){switch(r.label){case 0:return n=this.randomHex(32),o=this.buildRegisterPayload(e,t,n),[4,this.postPlainJson(this.ENDPOINTS.register,o)];case 1:return r.sent(),[2,{token:"",username:e}]}})})},e.signIn=function(e,t){return o(this,void 0,Promise,function(){var n,o,i,a,s;return r(this,function(r){switch(r.label){case 0:return[4,this.getFingerprint()];case 1:return n=r.sent(),o=this.buildLoginPayload(e,t,n),[4,this.postPlainJson(this.getLoginUrl(),o)];case 2:if(i=r.sent(),"undefined"!=typeof cc&&cc.log?cc.log("[AuthService] Login response:",i):console.log("[AuthService] Login response:",i),this._lastLoginData=i,this.saveProfileCacheFromLogin(i),!(a=this.extractToken(i)))throw s=this.extractErrorMessage(i)||"Login failed: token missing (check credentials)",new Error(s);return this.saveCurrentUser(e,a),[2,{token:a,username:e}]}})})},e.getCachedProfile=function(){return this.loadProfileCache()},e.saveProfileCacheFromLogin=function(e){var t=this.extractProfileFromLogin(e);if(t){var n=this.getStorage();n&&n.setItem(i.StorageKeys.AUTH_PROFILE,JSON.stringify(t))}},e.loadProfileCache=function(){var e=this.getStorage();if(!e)return null;var t=e.getItem(i.StorageKeys.AUTH_PROFILE);if(!t)return null;try{return JSON.parse(t)}catch(n){return null}},e.extractProfileFromLogin=function(e){if(!e)return null;var t=e.data||e.Data||e,n=Array.isArray(t)?t[0]:t;return n?{uid:n.uid||n.uuid||n.id,fullname:n.fullname,main_balance:n.main_balance,status:e.status||e.message,raw:e}:null},e.changeDisplayName=function(e,t,n){return o(this,void 0,Promise,function(){var o;return r(this,function(r){switch(r.label){case 0:return o={fullname:t,lang:n||this.getLang()},[4,this.postPlainJson(this.ENDPOINTS.changeDisplayName,o,{"x-token":e,"content-type":"application/json"})];case 1:return r.sent(),[2]}})})},e.logout=function(e){return o(this,void 0,Promise,function(){return r(this,function(t){switch(t.label){case 0:return[4,this.postPlainJson(this.ENDPOINTS.logout,{},{"x-token":e,"content-type":"application/json"})];case 1:return t.sent(),this.clearCurrentUser(),[2]}})})},e.buildLoginPayload=function(e,t,n){var o=this.getDeviceInfo(),r=Math.floor(Date.now()/1e3),i=this.computeSign(e,t,r);return{username:e,password:t,app_id:this.getAppId(),os:o.os,device:o.device,browser:o.browser,fg:n,time:r,sign:i,version:this.DEFAULTS.version,lang:this.getLang(),csrf:"",aff_id:this.DEFAULTS.affId}},e.getLoginUrl=function(){return this.ENDPOINTS.login},e.buildRegisterPayload=function(e,t,n){var o=this.getDeviceInfo(),r=Math.floor(Date.now()/1e3),i=this.computeSign(e,t,r);return{fullname:e,username:e,password:t,app_id:this.getAppId(),avatar:this.DEFAULTS.avatar,os:o.os,device:o.device,browser:o.browser,fg:n,time:r,sign:i,aff_id:this.DEFAULTS.affId,lang:this.getLang(),csrf:"",ref_id:"",version:this.DEFAULTS.version}},e.postPlainJson=function(e,t,n){return o(this,void 0,Promise,function(){var o;return r(this,function(r){switch(r.label){case 0:return[4,fetch(e,{method:"POST",headers:this.mergeHeaders({"content-type":"text/plain;charset=UTF-8"},n),body:JSON.stringify(t)})];case 1:return o=r.sent(),[2,this.parseResponse(o)]}})})},e.postJson=function(e,t,n){return o(this,void 0,Promise,function(){var o;return r(this,function(r){switch(r.label){case 0:return[4,fetch(e,{method:"POST",headers:this.mergeHeaders({"content-type":"application/json"},n),body:JSON.stringify(t)})];case 1:return o=r.sent(),[2,this.parseResponse(o)]}})})},e.getJson=function(e,t){return o(this,void 0,Promise,function(){var n;return r(this,function(o){switch(o.label){case 0:return[4,fetch(e,{method:"GET",headers:this.mergeHeaders({},t)})];case 1:return n=o.sent(),[2,this.parseResponse(n)]}})})},e.parseResponse=function(e){return o(this,void 0,Promise,function(){var t,n,o;return r(this,function(r){switch(r.label){case 0:return[4,e.text()];case 1:t=r.sent(),n=null;try{n=t?JSON.parse(t):null}catch(i){n={raw:t}}if(!e.ok)throw o=this.extractErrorMessage(n)||"HTTP "+e.status,new Error(o);return[2,n]}})})},e.extractToken=function(e){if(!e)return"";var t=e.Token||e.token||e.session||e.sessionId||e.session_id;if(t)return t;var n=e.data||e.Data||e;if("string"==typeof n)try{n=JSON.parse(n)}catch(r){}if(Array.isArray(n)&&n.length>0){var o=n[0];return o.Token||o.token||o.session||o.sessionId||o.session_id||""}return n&&"object"==typeof n&&(n.Token||n.token||n.session||n.sessionId||n.session_id)||""},e.extractErrorMessage=function(e){return e&&(e.message||e.msg||e.error||e.err_msg||e.StatusMessage||e.data&&(e.data.message||e.data.msg||e.data.error||e.data.err_msg))||""},e.getDeviceInfo=function(){var e="unknown",t="unknown",n="Computer";return"undefined"!=typeof cc&&cc.sys?(e=cc.sys.os||e,t=cc.sys.browserType||t,n=cc.sys.isMobile?"Mobile":"Computer"):"undefined"!=typeof navigator&&(e=navigator.platform||e,t=navigator.userAgent||t),"OSX"===e&&(e="OS X"),{os:e,device:n,browser:t}},e.computeSign=function(){return""},e.getFingerprint=function(){var e=this.getStorage();if(!e)return this.randomHex(32);var t=e.getItem(i.StorageKeys.AUTH_FINGERPRINT);return t||(t=this.randomHex(32),e.setItem(i.StorageKeys.AUTH_FINGERPRINT,t)),t},e.randomHex=function(e){for(var t="",n=0;n<e;n+=1)t+=Math.floor(16*Math.random()).toString(16);return t},e.getAppId=function(){return a.PortalContextService.getAppId&&a.PortalContextService.getAppId()||this.DEFAULTS.appId},e.getLang=function(){return a.PortalContextService.getLanguage&&a.PortalContextService.getLanguage()||"en"},e.getLangForApi=function(){return"VN"===(a.PortalContextService.getMarket&&a.PortalContextService.getMarket())?"vn":"th"===this.getLang()?"th":"en"},e.mergeHeaders=function(e,t){var n={};return Object.keys(e||{}).forEach(function(t){n[t]=e[t]}),Object.keys(t||{}).forEach(function(e){n[e]=t[e]}),n},e.saveCurrentUser=function(e,t){var n=this.getStorage();n&&(n.setItem(i.StorageKeys.AUTH_USER,e),n.setItem(i.StorageKeys.USER_TOKEN,t))},e.clearCurrentUser=function(){var e=this.getStorage();e&&(e.removeItem(i.StorageKeys.AUTH_USER),e.removeItem(i.StorageKeys.USER_TOKEN))},e.getStorage=function(){return"undefined"==typeof localStorage?null:localStorage},e.ENDPOINTS={register:"https://apigw-111.sgame.us/user/register.aspx",login:"https://apigw-111.sgame.us/user/login.aspx",changeDisplayName:"https://apigw-111.sgame.us/gwms/v1/u/change/displayname.aspx",logout:"https://apigw-111.sgame.us/user/logout.aspx"},e.DEFAULTS={appId:"bc116112",affId:"bc116222",avatar:"Avatar8",version:"0.0.30"},e._lastLoginData=null,e}();n.AuthService=s,cc._RF.pop()},{"../constants/StorageKeys":"StorageKeys","./PortalContextService":"PortalContextService"}],ConfigService:[function(e,t,n){"use strict";cc._RF.push(t,"f9197nNFvZMFL/aDLUfBU6M","ConfigService");var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{c(o.next(e))}catch(t){i(t)}}function s(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((o=o.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.ConfigService=void 0;var i=e("../core/PortalContextService"),a=e("../constants/Config"),s=function(){function e(){}return e.loadConfig=function(){return o(this,void 0,Promise,function(){var e,t,n,o,a;return r(this,function(r){switch(r.label){case 0:e=i.PortalContextService.getEnvironment(),console.log("[ConfigService] Current env:",e),t=this.getBaseUrl()+"/games-"+e+".json",console.log("[ConfigService] Fetching config from:",t),r.label=1;case 1:return r.trys.push([1,4,,5]),[4,fetch(t,{cache:"no-store"})];case 2:if(!(n=r.sent()).ok)throw new Error("Config HTTP "+n.status);return[4,n.json()];case 3:return(o=r.sent()).env!==e&&console.warn("[ConfigService] Env mismatch: expected "+e+", got "+o.env),this._cache=o,console.log("[ConfigService] Config loaded",o),[2,o];case 4:throw a=r.sent(),console.error("[ConfigService] Failed to load config",a),a;case 5:return[2]}})})},e.getSlots=function(){return this._cache?this._cache.slots:[]},e.clearCache=function(){this._cache=null},e.getBaseUrl=function(){return a.getPortalConfigsBaseUrl()},e._cache=null,e}();n.ConfigService=s,cc._RF.pop()},{"../constants/Config":"Config","../core/PortalContextService":"PortalContextService"}],Config:[function(e,t,n){"use strict";cc._RF.push(t,"d0d13eja9pMGaKd2uTxklbZ","Config"),Object.defineProperty(n,"__esModule",{value:!0}),n.getPortalConfigsBaseUrl=n.PORTAL_CONFIGS_PATH=n.CDN_BASE_URL=void 0,n.CDN_BASE_URL="__CDN_BASE_URL__",n.PORTAL_CONFIGS_PATH="/portal-configs",n.getPortalConfigsBaseUrl=function(){if("undefined"!=typeof window&&window.location&&window.location.origin){var e=window.location.hostname;return"localhost"===e||"127.0.0.1"===e?"https://c6-assets-dev.c6gamestag.win/portal-configs":""+window.location.origin+n.PORTAL_CONFIGS_PATH}return""+("__CDN_BASE_URL__"===n.CDN_BASE_URL?"https://c6-assets-dev.c6gamestag.win":n.CDN_BASE_URL)+n.PORTAL_CONFIGS_PATH},cc._RF.pop()},{}],EventBridge:[function(e,t,n){"use strict";cc._RF.push(t,"95fe9h/G7ZJh4aV4QiqZVPZ","EventBridge");var o=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=e("./RemoteBundleLoader"),i=e("./PortalContextService"),a=e("../constants/PortalEvents"),s=cc._decorator.ccclass,c=function(){function e(){}return e.init=function(){this._initialized?cc.warn("[EventBridge] Already initialized"):(this._initialized=!0,cc.director.on(a.PortalEvents.PORTAL_LAUNCH_GAME,this.onLaunchGame,this),cc.director.on(a.PortalEvents.BACK_TO_LOBBY,this.onBackToLobby,this),cc.director.on(a.PortalEvents.SHOW_POPUP,this.onShowPopup,this),cc.director.on(a.PortalEvents.UPDATE_SFX,this.onUpdateSfx,this),cc.log("[EventBridge] Initialized"))},e.onLaunchGame=function(e){var t;if(i.PortalContextService.getToken()){cc.log("[EventBridge] Launch game:",e.gameId);var n=null===(t=cc.find("Canvas/LobbyRoot"))||void 0===t?void 0:t.getComponent("LobbyUIController");n&&n.disableAllCards(),cc.director.loadScene("GameHostScene",function(){var t=cc.find("Canvas/GameHostUIController").getComponent("GameHostUIController");if(t.showLoading(),!e.bundle)return cc.error("[EventBridge] Game Bundle URL is missing for",e.game_id),t.hideLoading(),void cc.director.loadScene("LobbyScene");r.default.loadGame(e.bundle,t.gameRoot).then(function(){return t.hideLoading()}).catch(function(e){cc.error("[EventBridge] Load failed",e),cc.director.loadScene("LobbyScene")})})}else{cc.log("[EventBridge] User not logged in. Opening Sign In panel.");var o=cc.find("Canvas/LobbyRoot");if(o){var a=o.getComponent("LobbyUIController");a&&a.onClickOpenSignIn&&a.onClickOpenSignIn()}}},e.onBackToLobby=function(){cc.log("[EventBridge] Back to Lobby"),r.default.unloadGame(),cc.director.loadScene("LobbyScene")},e.onShowPopup=function(e){cc.log("[EventBridge] Show popup:",e)},e.onUpdateSfx=function(e){cc.log("[EventBridge] Update SFX:",e.enableSound),i.PortalContextService.setSoundEnabled(e.enableSound)},e._initialized=!1,o([s],e)}();n.default=c,cc._RF.pop()},{"../constants/PortalEvents":"PortalEvents","./PortalContextService":"PortalContextService","./RemoteBundleLoader":"RemoteBundleLoader"}],GameCardController:[function(e,t,n){"use strict";cc._RF.push(t,"a2054NtjxtESZ0MoW9raUFl","GameCardController");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../constants/PortalEvents"),s=cc._decorator,c=s.ccclass,l=(s.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.button=null,t._gameData=null,t}return r(t,e),t.prototype.onLoad=function(){this.button=this.getComponent(cc.Button)},t.prototype.init=function(e){this._gameData=e,this.setInteractable(!0)},t.prototype.onClick=function(){this._gameData&&cc.director.emit(a.PortalEvents.PORTAL_LAUNCH_GAME,this._gameData)},t.prototype.setInteractable=function(e){this.button&&(this.button.interactable=e)},t.prototype.reset=function(){this._gameData=null,this.setInteractable(!0)},i([c],t)}(cc.Component));n.default=l,cc._RF.pop()},{"../constants/PortalEvents":"PortalEvents"}],GameEntry:[function(e,t,n){"use strict";cc._RF.push(t,"45ca5VlxANK2oasrmYAQarF","GameEntry");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator.ccclass,s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.onLoad=function(){this.readRuntimeContext()},t.prototype.readRuntimeContext=function(){var e=localStorage.getItem("user_token"),t=localStorage.getItem("appLanguage"),n=localStorage.getItem("enableSound");cc.log("[GameEntry] Context:",{token:e,lang:t,sound:n})},t.prototype.onExitGame=function(){cc.director.emit("INTEGRATION_BACK_TO_LOBBY")},t.prototype.onToggleSound=function(e){cc.director.emit("UPDATE_SFX_SETTING",{enableSound:e})},i([a],t)}(cc.Component);n.default=s,cc._RF.pop()},{}],GameHostUIController:[function(e,t,n){"use strict";cc._RF.push(t,"6ebf1Z+luBPIIbLckgL4AXy","GameHostUIController");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../constants/PortalEvents"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gameRoot=null,t.loadingNode=null,t}return r(t,e),t.prototype.onLoad=function(){this.gameRoot&&this.gameRoot.removeAllChildren(),this.loadingNode&&(this.loadingNode.active=!1)},t.prototype.onBackToLobby=function(){cc.director.emit(a.PortalEvents.BACK_TO_LOBBY)},t.prototype.showLoading=function(){this.loadingNode&&(this.loadingNode.active=!0)},t.prototype.hideLoading=function(){this.loadingNode&&(this.loadingNode.active=!1)},t.prototype.onDestroy=function(){this.gameRoot&&this.gameRoot.removeAllChildren()},i([l(cc.Node)],t.prototype,"gameRoot",void 0),i([l(cc.Node)],t.prototype,"loadingNode",void 0),i([c],t)}(cc.Component);n.default=u,cc._RF.pop()},{"../constants/PortalEvents":"PortalEvents"}],LoadingOverlay:[function(e,t,n){"use strict";cc._RF.push(t,"772d7x2Iv5EHoyjdl57ADh2","LoadingOverlay");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.text="hello",t}return r(t,e),t.prototype.start=function(){},i([c(cc.Label)],t.prototype,"label",void 0),i([c],t.prototype,"text",void 0),i([s],t)}(cc.Component);n.default=l,cc._RF.pop()},{}],LobbyUIController:[function(e,t,n){"use strict";cc._RF.push(t,"620366/8RxIEKHvJ5RtNXzB","LobbyUIController");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},a=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{c(o.next(e))}catch(t){i(t)}}function s(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((o=o.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,u=c.property,h=e("../core/ConfigService"),g=e("../core/PortalContextService"),d=e("../core/EventBridge"),p=e("../game/GameCardController"),f=e("../core/AuthService"),v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gameListContent=null,t.gameCardPrefab=null,t.errorPanel=null,t.signInPanel=null,t.signUpPanel=null,t.signInButton=null,t.signUpButton=null,t.signInSubmitButton=null,t.signUpSubmitButton=null,t.signInCloseButton=null,t.signUpCloseButton=null,t.authGuestPanel=null,t.authUserPanel=null,t.lblProfileName=null,t.lblProfileBalance=null,t.logoutButton=null,t.signInUsername=null,t.signInPassword=null,t.signUpUsername=null,t.signUpPassword=null,t.signUpPasswordRe=null,t.signInShowPass=null,t.signUpShowPass=null,t.signUpShowPassRe=null,t._errorLabel=null,t._profileLoaded=!1,t._cardPool=new cc.NodePool,t._gameList=[],t}return r(t,e),t.prototype.onLoad=function(){g.PortalContextService.init(),d.default.init(),this.initAuthUi(),this.loadGameList(),this.updateAuthGate(),this.loadUserProfileIfNeeded()},t.prototype.onDestroy=function(){this._cardPool.clear()},t.prototype.loadGameList=function(){return a(this,void 0,void 0,function(){var e,t;return s(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,h.ConfigService.loadConfig()];case 1:return e=n.sent(),this._gameList=e.slots||[],this.renderGames(this._gameList),[3,3];case 2:return t=n.sent(),cc.error("[Lobby] Failed to load config",t),this.showError("Failed to load game list"),[3,3];case 3:return[2]}})})},t.prototype.renderGames=function(e){var t=this;this.clearGameList(),e&&0!==e.length?(e.forEach(function(e){var n=t.getCardFromPool();n.parent=t.gameListContent,t.loadThumbnail(n,e.thumbnail),n.getChildByName("lblGameName").getComponent(cc.Label).string=e.name,n.getChildByName("lblGameDesc").getComponent(cc.Label).string=e.description,n.getComponent(p.default).init(e)}),this.updateAuthGate()):this.showError("No games available")},t.prototype.loadThumbnail=function(e,t){var n=e.getChildByName("Mask").getChildByName("Thumbnail").getComponent(cc.Sprite);cc.assetManager.loadRemote(t,function(e,o){e?cc.warn("Thumbnail load failed:",t):n.spriteFrame=new cc.SpriteFrame(o)})},t.prototype.clearGameList=function(){var e=this;this.gameListContent.children.forEach(function(t){var n=t.getComponent(p.default);n&&n.reset(),e._cardPool.put(t)}),this.gameListContent.removeAllChildren()},t.prototype.showError=function(e){if(void 0===e&&(e="Failed to load game list"),this.errorPanel&&(this.errorPanel.active=!0),!this._errorLabel){var t=this.errorPanel?this.errorPanel.getChildByName("lblError"):null;this._errorLabel=t?t.getComponent(cc.Label):null}this._errorLabel&&(this._errorLabel.string=e),cc.warn("[Lobby]",e)},t.prototype.getCardFromPool=function(){return this._cardPool.size()>0?this._cardPool.get():cc.instantiate(this.gameCardPrefab)},t.prototype.disableAllCards=function(){this.gameListContent.children.forEach(function(e){var t=e.getComponent("GameCardController");t&&t.setInteractable(!1)})},t.prototype.updateAuthGate=function(){var e=!(!g.PortalContextService.getToken||!g.PortalContextService.getToken());this.authGuestPanel&&(this.authGuestPanel.active=!e),this.authUserPanel&&(this.authUserPanel.active=e),this.setCardsInteractable(!0)},t.prototype.setCardsInteractable=function(e){this.gameListContent.children.forEach(function(t){var n=t.getComponent("GameCardController");n&&n.setInteractable(e)})},t.prototype.loadUserProfileIfNeeded=function(e){return void 0===e&&(e=!1),a(this,void 0,void 0,function(){var t;return s(this,function(){return this._profileLoaded&&!e?[2]:g.PortalContextService.getToken&&g.PortalContextService.getToken()&&(t=f.AuthService.getCachedProfile())?(this.lblProfileName&&(this.lblProfileName.string=t.fullname||"User"),this.lblProfileBalance&&"number"==typeof t.main_balance&&(this.lblProfileBalance.string=String(t.main_balance)),this._profileLoaded=!0,[2]):[2]})})},t.prototype.clearProfileUi=function(){this.lblProfileName&&(this.lblProfileName.string=""),this.lblProfileBalance&&(this.lblProfileBalance.string="")},t.prototype.initAuthUi=function(){this.signInShowPass&&this.setPasswordVisible(this.signInPassword,this.signInShowPass.isChecked),this.signUpShowPass&&this.setPasswordVisible(this.signUpPassword,this.signUpShowPass.isChecked),this.signUpShowPassRe&&this.setPasswordVisible(this.signUpPasswordRe,this.signUpShowPassRe.isChecked)},t.prototype.onClickCloseError=function(){this.clearError()},t.prototype.onClickOpenSignIn=function(){this.showPanel(this.signInPanel)},t.prototype.onClickOpenSignUp=function(){this.showPanel(this.signUpPanel)},t.prototype.onClickCloseSignIn=function(){this.hidePanel(this.signInPanel)},t.prototype.onClickCloseSignUp=function(){this.hidePanel(this.signUpPanel)},t.prototype.onToggleSignInShowPass=function(){this.setPasswordVisible(this.signInPassword,!!this.signInShowPass&&this.signInShowPass.isChecked)},t.prototype.onToggleSignUpShowPass=function(){this.setPasswordVisible(this.signUpPassword,!!this.signUpShowPass&&this.signUpShowPass.isChecked)},t.prototype.onToggleSignUpShowPassRe=function(){this.setPasswordVisible(this.signUpPasswordRe,!!this.signUpShowPassRe&&this.signUpShowPassRe.isChecked)},t.prototype.showPanel=function(e){e&&(e===this.signInPanel&&this.signUpPanel&&(this.signUpPanel.active=!1),e===this.signUpPanel&&this.signInPanel&&(this.signInPanel.active=!1),this.clearError(),e.active=!0)},t.prototype.hidePanel=function(e){e&&(e.active=!1,this.clearInputs(e),this.clearError())},t.prototype.clearInputs=function(e){e&&e.getComponentsInChildren(cc.EditBox).forEach(function(e){return e.string=""})},t.prototype.clearError=function(){this.errorPanel&&(this.errorPanel.active=!1)},t.prototype.setPasswordVisible=function(e,t){e&&(e.inputFlag=t?cc.EditBox.InputFlag.DEFAULT:cc.EditBox.InputFlag.PASSWORD,e.string=e.string)},t.prototype.onSignIn=function(){return a(this,void 0,void 0,function(){var e,t,n,o,r;return s(this,function(i){switch(i.label){case 0:if(e=(this.signInUsername&&this.signInUsername.string||"").trim(),t=this.signInPassword?this.signInPassword.string:"",n=this.validateCredentials(e,t))return this.showError(n),[2];this.setAuthButtonsEnabled(!1),i.label=1;case 1:return i.trys.push([1,4,5,6]),[4,f.AuthService.signIn(e,t)];case 2:return o=i.sent(),g.PortalContextService.setToken(o.token),this.hidePanel(this.signInPanel),this.updateAuthGate(),[4,this.loadUserProfileIfNeeded(!0)];case 3:return i.sent(),[3,6];case 4:return r=i.sent(),this.showError(r&&r.message?r.message:"Login failed"),[3,6];case 5:return this.setAuthButtonsEnabled(!0),[7];case 6:return[2]}})})},t.prototype.onSignUp=function(){return a(this,void 0,void 0,function(){var e,t,n,o,r;return s(this,function(i){switch(i.label){case 0:if(e=(this.signUpUsername&&this.signUpUsername.string||"").trim(),t=this.signUpPassword?this.signUpPassword.string:"",n=this.signUpPasswordRe?this.signUpPasswordRe.string:"",o=this.validateCredentials(e,t,n))return this.showError(o),[2];this.setAuthButtonsEnabled(!1),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,f.AuthService.signUp(e,t)];case 2:return i.sent(),this.hidePanel(this.signUpPanel),"undefined"!=typeof cc&&cc.log&&cc.log("[Lobby] Sign up successful. Please sign in."),this.updateAuthGate(),[3,5];case 3:return r=i.sent(),this.showError(r&&r.message?r.message:"Sign up failed"),[3,5];case 4:return this.setAuthButtonsEnabled(!0),[7];case 5:return[2]}})})},t.prototype.onLogout=function(){return a(this,void 0,void 0,function(){var e,t;return s(this,function(n){switch(n.label){case 0:if(!(e=g.PortalContextService.getToken&&g.PortalContextService.getToken()))return this.updateAuthGate(),[2];this.setAuthButtonsEnabled(!1),n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,f.AuthService.logout(e)];case 2:return n.sent(),[3,5];case 3:return t=n.sent(),g.PortalContextService.setToken(""),this.showError(t&&t.message?t.message:"Logout failed"),[3,5];case 4:return this._profileLoaded=!1,this.clearProfileUi(),this.updateAuthGate(),this.setAuthButtonsEnabled(!0),[7];case 5:return[2]}})})},t.prototype.setAuthButtonsEnabled=function(e){[this.signInButton,this.signUpButton,this.signInSubmitButton,this.signUpSubmitButton,this.signInCloseButton,this.signUpCloseButton,this.logoutButton].filter(Boolean).forEach(function(t){var n=t.getComponent(cc.Button);n&&(n.interactable=e)})},t.prototype.validateCredentials=function(e,t,n){return e?e.length>15?"Username must be at most 15 characters":e.length<6?"Username must be at least 6 characters":t.length<8?"Password must be at least 8 characters":t.length>15?"Password must be at most 15 characters":"string"==typeof n&&n!==t?"Passwords do not match":"":"Username is required"},i([u(cc.Node)],t.prototype,"gameListContent",void 0),i([u(cc.Prefab)],t.prototype,"gameCardPrefab",void 0),i([u(cc.Node)],t.prototype,"errorPanel",void 0),i([u(cc.Node)],t.prototype,"signInPanel",void 0),i([u(cc.Node)],t.prototype,"signUpPanel",void 0),i([u(cc.Node)],t.prototype,"signInButton",void 0),i([u(cc.Node)],t.prototype,"signUpButton",void 0),i([u(cc.Node)],t.prototype,"signInSubmitButton",void 0),i([u(cc.Node)],t.prototype,"signUpSubmitButton",void 0),i([u(cc.Node)],t.prototype,"signInCloseButton",void 0),i([u(cc.Node)],t.prototype,"signUpCloseButton",void 0),i([u(cc.Node)],t.prototype,"authGuestPanel",void 0),i([u(cc.Node)],t.prototype,"authUserPanel",void 0),i([u(cc.Label)],t.prototype,"lblProfileName",void 0),i([u(cc.Label)],t.prototype,"lblProfileBalance",void 0),i([u(cc.Node)],t.prototype,"logoutButton",void 0),i([u(cc.EditBox)],t.prototype,"signInUsername",void 0),i([u(cc.EditBox)],t.prototype,"signInPassword",void 0),i([u(cc.EditBox)],t.prototype,"signUpUsername",void 0),i([u(cc.EditBox)],t.prototype,"signUpPassword",void 0),i([u(cc.EditBox)],t.prototype,"signUpPasswordRe",void 0),i([u(cc.Toggle)],t.prototype,"signInShowPass",void 0),i([u(cc.Toggle)],t.prototype,"signUpShowPass",void 0),i([u(cc.Toggle)],t.prototype,"signUpShowPassRe",void 0),i([l],t)}(cc.Component);n.default=v,cc._RF.pop()},{"../core/AuthService":"AuthService","../core/ConfigService":"ConfigService","../core/EventBridge":"EventBridge","../core/PortalContextService":"PortalContextService","../game/GameCardController":"GameCardController"}],PortalContextService:[function(e,t,n){"use strict";cc._RF.push(t,"af83dml4eFIF4n0miCB64n7","PortalContextService"),Object.defineProperty(n,"__esModule",{value:!0}),n.PortalContextService=void 0;var o=e("../constants/StorageKeys"),r=function(){function e(){}return e.init=function(){localStorage.getItem(o.StorageKeys.ENVIRONMENT)||localStorage.setItem(o.StorageKeys.ENVIRONMENT,"dev"),localStorage.getItem(o.StorageKeys.ENVIRONMENT_LEGACY)||localStorage.setItem(o.StorageKeys.ENVIRONMENT_LEGACY,localStorage.getItem(o.StorageKeys.ENVIRONMENT)||"dev"),localStorage.getItem(o.StorageKeys.APP_LANGUAGE)||localStorage.setItem(o.StorageKeys.APP_LANGUAGE,"en"),localStorage.getItem(o.StorageKeys.ENABLE_SOUND)||localStorage.setItem(o.StorageKeys.ENABLE_SOUND,"1"),localStorage.getItem(o.StorageKeys.ENABLE_BGM)||localStorage.setItem(o.StorageKeys.ENABLE_BGM,"1");var e=this.getToken&&this.getToken();console.log("[Storage] Token:",e)},e.setEnvironment=function(e){localStorage.setItem(o.StorageKeys.ENVIRONMENT,e),localStorage.setItem(o.StorageKeys.ENVIRONMENT_LEGACY,e)},e.getEnvironment=function(){return localStorage.getItem(o.StorageKeys.ENVIRONMENT)||localStorage.getItem(o.StorageKeys.ENVIRONMENT_LEGACY)},e.setLanguage=function(e){localStorage.setItem(o.StorageKeys.APP_LANGUAGE,e)},e.getLanguage=function(){return localStorage.getItem(o.StorageKeys.APP_LANGUAGE)},e.setSoundEnabled=function(e){localStorage.setItem(o.StorageKeys.ENABLE_SOUND,e?"1":"0")},e.isSoundEnabled=function(){var e=localStorage.getItem(o.StorageKeys.ENABLE_SOUND);return"1"===e||"true"===e},e.setMarket=function(e){localStorage.setItem(o.StorageKeys.SELECTED_MARKET,e)},e.getMarket=function(){return localStorage.getItem(o.StorageKeys.SELECTED_MARKET)||"VN"},e.getCurrency=function(){return"VN"===this.getMarket()?"VND":"THB"},e.getAppId=function(){return this.getMarket(),"bc116112"},e.setToken=function(e){localStorage.setItem(o.StorageKeys.USER_TOKEN,e)},e.getToken=function(){return localStorage.getItem(o.StorageKeys.USER_TOKEN)},e}();n.PortalContextService=r,cc._RF.pop()},{"../constants/StorageKeys":"StorageKeys"}],PortalEvents:[function(e,t,n){"use strict";cc._RF.push(t,"2437a/aYrxPV55VLiblch19","PortalEvents"),Object.defineProperty(n,"__esModule",{value:!0}),n.PortalEvents=void 0,n.PortalEvents={PORTAL_LAUNCH_GAME:"PORTAL_LAUNCH_GAME",BACK_TO_LOBBY:"INTEGRATION_BACK_TO_LOBBY",SHOW_POPUP:"MINI_GAME_SHOW_POPUP",UPDATE_SFX:"UPDATE_SFX_SETTING"},cc._RF.pop()},{}],RemoteBundleLoader:[function(e,t,n){"use strict";cc._RF.push(t,"4e9eakdxs5BzJwPANldPclW","RemoteBundleLoader");var o=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=e("../game/GameEntry"),i=cc._decorator.ccclass,a=function(){function e(){}return e.loadGame=function(e,t){var n=this;return new Promise(function(o,r){cc.assetManager.loadBundle(e,function(i,a){if(i)return n.logLoadBundleError(e,i),void r(i);n._activeBundle=a,n.launchGame(a,t).then(o).catch(r)})})},e.launchGame=function(e,t){var n=this;return new Promise(function(o,i){e.load("GameEntry",cc.Prefab,function(e,a){if(e)return cc.error("[RemoteBundleLoader] Entry prefab missing"),void i(e);var s=cc.instantiate(a);s.getComponent(r.default)||(cc.log("[RemoteBundleLoader] Injecting GameEntry script automatically"),s.addComponent(r.default)),s.parent=t,n._gameRoot=s,o()})})},e.unloadGame=function(){cc.log("[RemoteBundleLoader] Unloading game"),cc.director.targetOff(this),this.destroyGameRoot(),this._activeBundle&&(this._activeBundle.releaseAll(),cc.assetManager.removeBundle(this._activeBundle),this._activeBundle=null)},e.destroyGameRoot=function(){this._gameRoot&&cc.isValid(this._gameRoot)&&(this._gameRoot.destroy(),this._gameRoot=null)},e.logLoadBundleError=function(e,t){var n=t&&t.message?t.message:String(t);n.includes("403")||n.includes("Forbidden")?cc.error("[RemoteBundleLoader] Bundle load failed: 403 Forbidden\nCheck server permissions/CORS for:\n- "+e+"config.json\n- "+e+"index.js"):n.includes("404")||n.includes("Not Found")?cc.error("[RemoteBundleLoader] Bundle not found:",e):cc.error("[RemoteBundleLoader] Bundle load failed:",t)},e._activeBundle=null,e._gameRoot=null,o([i],e)}();n.default=a,cc._RF.pop()},{"../game/GameEntry":"GameEntry"}],StorageKeys:[function(e,t,n){"use strict";cc._RF.push(t,"6b418dJ25xDybseDK2DpwOW","StorageKeys"),Object.defineProperty(n,"__esModule",{value:!0}),n.StorageKeys=void 0,n.StorageKeys={USER_TOKEN:"user_token",AUTH_USER:"auth_user",AUTH_USERS:"auth_users",AUTH_FINGERPRINT:"auth_fingerprint",AUTH_PROFILE:"auth_profile",ENVIRONMENT:"environment",ENVIRONMENT_LEGACY:"enviroment",APP_LANGUAGE:"appLanguage",ENABLE_SOUND:"enableSound",ENABLE_BGM:"enableBackgroundMusic",FORCE_MOCK_GAME:"forceMockGame",BASE_URL:"base_url",SELECTED_MARKET:"selected_market"},cc._RF.pop()},{}]},{},["Config","PortalEvents","StorageKeys","AuthService","ConfigService","EventBridge","PortalContextService","RemoteBundleLoader","GameCardController","GameEntry","GameHostUIController","LoadingOverlay","LobbyUIController"]);